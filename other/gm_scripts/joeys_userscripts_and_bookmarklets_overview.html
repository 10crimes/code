<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
"http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
 <HEAD>
  <TITLE>Joey's Userscripts and Bookmarklets Overview</TITLE>
 <META NAME="generator", CONTENT="mod_autoindex"> </HEAD>
 <BODY bgcolor="#ffffff" text="#000000">
	 <script type="text/javascript">

function addScript(url) {
	var s = document.createElement("script");
	s.type = "text/javascript";
	s.src = url;
	document.getElementsByTagName("head")[0].appendChild(s);
}

// addScript("http://hwi.ath.cx/code/other/gm_scripts/focus/focus.js");

// if (this.console && console.log) {
	// console.log("script elements = "+document.getElementsByTagName("script").length);
// }

/* XHR */

if (this.XMLHttpRequest) {

	function once(f) {
		var done = false;
		return function() {
			if (!done) {
				f();
				done = true;
			}
		};
	}

	function gotIt() {
		// alert("Got responseText: "+req.responseText);
		div = document.createElement("div");
		div.innerHTML = req.responseText;
		while (div.childNodes.length) {
			document.body.appendChild(div.childNodes[0]);
		}
		setTimeout(function(){
			addScript("http://hwi.ath.cx/code/other/gm_scripts/make_bookmarklet_from_us/make_bookmarklet_from_us.user.js?dummy="+Math.random());
			// addScript("http://hwi.ath.cx/javascript/focus.js");
		},100);
	}

	var gotItOnce = once(gotIt);

	var req = new XMLHttpRequest();

	// Adopt current query params, or default to most-recent-at-top
	// Old: var query = ( document.location.search ? document.location.search : "?M=D" );
	var query = ( document.location.search ? document.location.search : "?C=M;O=D" );

	// Avoid caching (don't think this has ever been needed)
	// query += "&dummy="+new Date().getTime();

	var sync = true;
	// false (non-synchronized) fails in FF 3.5.15 and Konq 3.5.10

	req.open("GET", "http://hwi.ath.cx/code/other/gm_scripts/"+query, sync);
	req.send(null);

	// if (sync) {
		// If we are doing synchronized, then we must call gotIt manually:
		// gotIt();
		// setTimeout(gotIt,1);
	// }

	// Otherwise we act on callback:
	req.onreadystatechange = function (aEvt) {
		if (req.readyState == 4) {
			if(req.status == 200) {
				gotItOnce(req);
			} else {
				alert("XHR failed with status "+req.status+"\n");
			}
		}
	};

} else {
	alert("This page requires XMLHttpRequest.");
}

	</script>

	<!-- Still too early <script type="text/javascript" src="http://hwi.ath.cx/code/other/gm_scripts/make_bookmarklet_from_us/make_bookmarklet_from_us.user.js"></script> -->

</BODY></HTML>

